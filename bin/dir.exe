local args = {...}
local path = args[1] or "."

if not fs.exists(path) then
    print("Directory not found")
    return 0
end

if not fs.isDir(path) then
    print(path .. " is not a directory")
    return 0
end

term.setTextColor(colors.yellow)
print(" Directory of " .. shell.resolve(path))
term.setTextColor(colors.white)
print("")

local list = fs.list(path)
local fileCount, dirCount = 0, 0

for _, item in ipairs(list) do
    local fullPath = fs.combine(path, item)
    if fs.isDir(fullPath) then
        term.setTextColor(colors.cyan)
        print(string.format("%-20s <DIR>", item))
        dirCount = dirCount + 1
    else
        term.setTextColor(colors.white)
        print(string.format("%-20s %d bytes", item, fs.getSize(fullPath)))
        fileCount = fileCount + 1
    end
end

term.setTextColor(colors.lightGray)
print("")
print(string.format(" %d File(s)    %d Dir(s)", fileCount, dirCount))
term.setTextColor(colors.white)
